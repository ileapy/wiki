# 银联加密公钥更新查询接口

商户定期（1天1次）向银联全渠道系统发起获取加密公钥信息交易。在加密公钥证书更新期间，全渠道系统支持新老证书的共同使用，新老证书并行期为1个月。全渠道系统向商户返回最新的加密公钥证书，由商户服务器替换本地证书。

> 阅读本文之前请仔细阅读[手机支付控件 - 银联加密公钥更新查询接口](https://open.unionpay.com/tjweb/acproduct/APIList?acpAPIId=773&apiservId=450&version=V2.2&bussType=0)

## 接口调用

返回结果自行验签

```php
$params = [
    'orderId' => date('YmdHis'),
];

$res = $app->file->updatePublicKey($params);

if ($app->signature->validate($res)) {
    echo "验签成功";
}else
{
    echo "验签失败";
}
```

## 更多参数

| 中文名称     | 英文名称    | 域类型         | 默认值 | 请求要求     | 备注                                                         |
| :----------- | :---------- | :------------- | :----- | :----------- | :----------------------------------------------------------- |
| 版本号       | version     | NS5            | 无     | M-必填       | 固定填写                                                     |
| 编码方式     | encoding    | ANS1..20       | UTF-8  | M-必填       | 默认取值：UTF-8                                              |
| 产品类型     | bizType     | N6             | 无     | M-必填       |                                                              |
| 订单发送时间 | txnTime     | YYYYMMDDhhmmss | 无     | M-必填       | 商户发送交易时间                                             |
| 交易类型     | txnType     | N2             | 无     | M-必填       | 取值：95                                                     |
| 交易子类     | txnSubType  | N2             | 无     | M-必填       | 默认：00                                                     |
| 接入类型     | accessType  | N1             | 无     | M-必填       | 0：商户直连接入1：收单机构接入2：平台商户接入                |
| 签名         | signature   | ANS1..1024     | 0      | M-必填       | 填写对报文摘要的签名                                         |
| 签名方法     | signMethod  | N2             | 无     | M-必填       | 取值： 非对称签名： 01（表示采用RSA签名） HASH表示散列算法 11：支持散列方式验证SHA-256 12：支持散列方式验证SM3 |
| 渠道类型     | channelType | N2             | 无     | M-必填       |                                                              |
| 商户代码     | merId       | AN15           | 无     | M-必填       |                                                              |
| 商户订单号   | orderId     | AN8..40        | 无     | M-必填       | 商户订单号，不能含“-”或“_”;商户自定义，同一交易日期内不可重复;商户代码merId、商户订单号orderId、订单发送时间txnTime三要素唯一确定一笔交易。 |
| 证书类型     | certType    | N2             | 无     | M-必填       | 01：敏感信息加密公钥                                         |
| 二级商户代码 | subMerId    | AN5..15        | 无     | C-按条件必填 | 商户类型为平台类商户接入时必须上送                           |
| 二级商户简称 | subMerAbbr  | ANS1…16        | 无     | C-按条件必填 | 商户类型为平台类商户接入时必须上送                           |
| 二级商户名称 | subMerName  | ANS1..40       | 无     | C-按条件必填 | 商户类型为平台类商户接入时必须上送                           |
| 商户简称     | merAbbr     | ANS1..8        | 无     | C-按条件必填 | 接入类型为收单机构接入时需上送                               |
| 商户类别     | merCatCode  | N4             | 无     | C-按条件必填 | 接入类型为收单机构接入时需上送                               |
| 商户名称     | merName     | ANS1..40       | 无     | C-按条件必填 | 接入类型为收单机构接入时需上送                               |
| 收单机构代码 | acqInsCode  | AN8..11        | 无     | C-按条件必填 | 接入类型为收单机构接入时需上送                               |
| 证书ID       | certId      | N1..128        | 无     | C-按条件必填 | 签名方式01需要上送                                           |
| 保留域       | reserved    | ANS1..2048     | 无     | O-选填       |                               |
| 请求方保留域 | reqReserved | ANS1..1024     | 无     | O-选填       | 商户自定义保留域，交易应答时会原样返回                       |

## 返回数据

| 中文名称     | 英文名称          | 域类型         | 默认值 | 请求要求     | 备注                                                         |
| :----------- | :---------------- | :------------- | :----- | :----------- | :----------------------------------------------------------- |
| 签名         | signature         | ANS1..1024     | 0      | M-必填       |                                                              |
| 签名方法     | signMethod        | N2             | 无     | M-必填       |                                                              |
| 应答码       | respCode          | AN2            | 无     | M-必填       |                                                              |
| 应答信息     | respMsg           | ANS1..256      | 无     | M-必填       |                                                              |
| 加密公钥证书 | encryptPubKeyCert | AN2048         | 无     | C-按条件必填 | 加密公钥证书                                                 |
| 版本号       | version           | NS5            | 无     | R-需要返回   |                                                              |
| 编码方式     | encoding          | ANS1..20       | UTF-8  | R-需要返回   |                                                              |
| 产品类型     | bizType           | N6             | 无     | R-需要返回   |                                                              |
| 订单发送时间 | txnTime           | YYYYMMDDhhmmss | 无     | R-需要返回   |                                                              |
| 交易类型     | txnType           | N2             | 无     | R-需要返回   | 取值:95                                                      |
| 交易子类     | txnSubType        | N2             | 无     | R-需要返回   |                                                              |
| 接入类型     | accessType        | N1             | 无     | R-需要返回   | 0：商户直连接入1：收单机构接入2：平台商户接入                |
| 请求方保留域 | reqReserved       | ANS1..1024     | 无     | R-需要返回   |                                                              |
| 商户代码     | merId             | AN15           | 无     | R-需要返回   |                                                              |
| 商户订单号   | orderId           | AN8..40        | 无     | R-需要返回   | 商户订单号，不能含“-”或“_”;商户自定义，同一交易日期内不可重复;商户代码merId、商户订单号orderId、订单发送时间txnTime三要素唯一确定一笔交易。 |
| 收单机构代码 | acqInsCode        | AN8..11        | 无     | R-需要返回   |                                                              |
| 证书类型     | certType          | N2             | 无     | R-需要返回   |                                                              |
| 保留域       | reserved          | ANS1..2048     | 无     | O-选填       |                              |
| 签名公钥证书 | signPubKeyCert    | AN1..2048      | 无     | O-选填       | 此域填写银联签名公钥证书，使用RSA签名方式时，默认返回，如果ctrlRule第五位为1时，不返。 |
